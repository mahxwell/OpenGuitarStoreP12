language: java

jdk:
- openjdk8

sudo: required

services:
- docker

before_install:
- cd OpenGuitarStore/docker/dev

script:
- docker-compose -p guitarstoredb up -d database
- docker build -t mahxwell/eureka servers/02_eureka
- docker-compose -p guitarstoredb up -d eureka
- cd ../../guitar
- mvn test
- mvn --file pom.xml cobertura:cobertura coveralls:report
- cd ../order
- mvn test
- mvn --file pom.xml cobertura:cobertura coveralls:report
- cd ../reservation
- mvn test
- mvn --file pom.xml cobertura:cobertura coveralls:report
- cd ../review
- mvn test
- mvn --file pom.xml cobertura:cobertura coveralls:report
- cd ../user
- mvn test
- mvn --file pom.xml cobertura:cobertura coveralls:report
- cd ../docker/dev
- docker container stop eureka
- docker container stop guitarstore_db
- docker rm guitarstore_db
- docker rm eureka

after_success:
- mvn --file pom.xml cobertura:cobertura coveralls:report

notifications:
email: false
